# V8.5.1.7 - 邮件参数显示优化

## 变更目的

移除邮件参数配置表格中的固定配置参数，只显示优化后的参数。

## 修改内容

### 1. 调整参数列表

**修改文件**: `qwen_多币种智能版.py`, `deepseek_多币种智能版.py`
**位置**: 约10594行和10596行

**移除的固定配置参数**:
- `base_position_ratio` (基础仓位比例)
- `max_leverage` (最大杠杆)
- `max_concurrent_positions` (最大持仓数)

**新增的优化参数**:
- `atr_tp_multiplier` (止盈ATR倍数)
- `atr_stop_multiplier` (止损ATR倍数)
- `min_consensus` (最小共振指标数)

**最终显示参数**:
```python
params_to_show = [
    ('min_risk_reward', '最小盈亏比', ':.1f'),
    ('min_signal_score', '最低信号分数', ':.0f'),
    ('max_holding_hours', '最长持仓(小时)', ':.1f'),
    ('atr_tp_multiplier', '止盈ATR倍数', ':.1f'),
    ('atr_stop_multiplier', '止损ATR倍数', ':.1f'),
    ('min_consensus', '最小共振指标数', ':.0f'),
]
```

### 2. 简化参数读取逻辑

**修改前**: 需要判断参数类型，固定配置从`DEFAULT_LEARNING_CONFIG.global`读取，优化参数从`scalping_params/swing_params`读取

**修改后**: 所有参数统一从`scalping_params/swing_params`读取

```python
# 🔧 V8.5.1.7: 所有参数都从优化后的config读取
scalp_val = scalping_params.get(param_key, 0)
swing_val = swing_params.get(param_key, 0)
```

### 3. 简化格式处理

**移除**: `%`, `x`, `个`等特殊格式处理

**保留**: 统一使用数字格式（如`:.1f`, `:.0f`）

```python
# 所有参数都是数字格式，直接使用format
if isinstance(scalp_val, (int, float)):
    scalp_display = ('{' + param_format + '}').format(scalp_val)
else:
    scalp_display = str(scalp_val)

if isinstance(swing_val, (int, float)):
    swing_display = ('{' + param_format + '}').format(swing_val)
else:
    swing_display = str(swing_val)
```

## 修改影响

### 正面效果
1. **邮件更聚焦**: 只显示会被优化器调整的参数
2. **代码更简洁**: 移除固定配置的特殊处理逻辑
3. **信息更清晰**: 用户一眼就能看到哪些参数被优化了

### 参数说明

**现在邮件中显示的6个参数**均为被`backtest_optimizer_v8321.py`优化的参数:

| 参数 | 说明 | 优化器作用 |
|------|------|-----------|
| min_risk_reward | 最小盈亏比 | ✅ 被优化器调整 |
| min_signal_score | 最低信号分数 | ✅ 被优化器调整 |
| max_holding_hours | 最长持仓(小时) | ✅ 被优化器调整 |
| atr_tp_multiplier | 止盈ATR倍数 | ✅ 被优化器调整 |
| atr_stop_multiplier | 止损ATR倍数 | ✅ 被优化器调整 |
| min_consensus | 最小共振指标数 | ✅ 被优化器调整 |

**移除的3个固定配置参数**:

| 参数 | 说明 | 为何移除 |
|------|------|---------|
| base_position_ratio | 基础仓位比例 | ❌ 固定值，不被优化器调整 |
| max_leverage | 最大杠杆 | ❌ 固定值，不被优化器调整 |
| max_concurrent_positions | 最大持仓数 | ❌ 固定值，不被优化器调整 |

## 版本标记

- **版本**: V8.5.1.7
- **日期**: 2025-11-16
- **修改标识**: `🔧 V8.5.1.7: 只显示优化后的参数，移除固定配置`
- **影响文件**: `qwen_多币种智能版.py`, `deepseek_多币种智能版.py`

