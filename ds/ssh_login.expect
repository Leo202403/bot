#!/usr/bin/expect -f
# è‡ªåŠ¨åŒ–SSHç™»å½•è„šæœ¬

set timeout 300
set password "j1lUcf9TbdCzZkPL"

spawn ssh -o StrictHostKeyChecking=no root@43.100.52.142

expect {
    "*password:" {
        send "$password\r"
        expect "*#"
    }
    "*#" {}
    timeout {
        puts "è¿æ¥è¶…æ—¶"
        exit 1
    }
}

# æ‰§è¡Œæ£€æŸ¥å’Œæ›´æ–°
send "cd /root/10-23-bot\r"
expect "*#"

send "echo 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”'\r"
expect "*#"
send "echo 'ç¬¬1æ­¥ï¼šæ£€æŸ¥è¿›ç¨‹çŠ¶æ€'\r"
expect "*#"
send "echo 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”'\r"
expect "*#"
send "echo ''\r"
expect "*#"

send "supervisorctl status\r"
expect "*#"

send "echo ''\r"
expect "*#"
send "echo 'ğŸ” Pythonè¿›ç¨‹ï¼š'\r"
expect "*#"
send "ps aux | grep -E 'qwen|deepseek|å‰ç«¯' | grep -v grep\r"
expect "*#"

send "echo ''\r"
expect "*#"
send "echo 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”'\r"
expect "*#"
send "echo 'ç¬¬2æ­¥ï¼šæ›´æ–°ä»£ç '\r"
expect "*#"
send "echo 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”'\r"
expect "*#"

send "git pull origin main\r"
expect "*#"

send "echo ''\r"
expect "*#"
send "echo 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”'\r"
expect "*#"
send "echo 'ç¬¬3æ­¥ï¼šéªŒè¯ä¿®å¤'\r"
expect "*#"
send "echo 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”'\r"
expect "*#"

send "cd ds\r"
expect "*#"

send "grep -n 'V8.3.21ä¿®å¤.*æ¸…ç†NaN' qwen_å¤šå¸ç§æ™ºèƒ½ç‰ˆ.py | head -1\r"
expect "*#"

send "grep -n 'V8.3.21ä¿®å¤.*æ¸…ç†NaN' deepseek_å¤šå¸ç§æ™ºèƒ½ç‰ˆ.py | head -1\r"
expect "*#"

send "echo ''\r"
expect "*#"
send "echo 'âœ… å‡†å¤‡å°±ç»ªï¼Œä¿æŒè¿æ¥ç”¨äºå›æµ‹...'\r"
expect "*#"

# ä¿æŒäº¤äº’æ¨¡å¼
interact

