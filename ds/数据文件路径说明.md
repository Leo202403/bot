# æ•°æ®æ–‡ä»¶è·¯å¾„è¯´æ˜

**ç‰ˆæœ¬**: V8.5.2.4.47  
**æœ€åæ›´æ–°**: 2025-11-19

---

## ğŸ“‚ ç›®å½•ç»“æ„

```
10-23-bot/
â”œâ”€â”€ ds/
â”‚   â”œâ”€â”€ deepseek_å¤šå¸ç§æ™ºèƒ½ç‰ˆ.py          # ä¸»ç¨‹åº
â”‚   â”œâ”€â”€ qwen_å¤šå¸ç§æ™ºèƒ½ç‰ˆ.py              # ä¸»ç¨‹åº
â”‚   â””â”€â”€ trading_data/                     # æ•°æ®æ ¹ç›®å½•
â”‚       â”œâ”€â”€ deepseek/                     # DeepSeekæ•°æ®ç›®å½•
â”‚       â”‚   â”œâ”€â”€ trades_history.csv        # âœ… äº¤æ˜“å†å²ï¼ˆæ‰€æœ‰è®¢å•ï¼‰
â”‚       â”‚   â”œâ”€â”€ current_positions.csv     # å½“å‰æŒä»“
â”‚       â”‚   â”œâ”€â”€ system_status.json        # ç³»ç»ŸçŠ¶æ€
â”‚       â”‚   â”œâ”€â”€ learning_config.json      # å­¦ä¹ é…ç½®
â”‚       â”‚   â”œâ”€â”€ position_contexts.json    # æŒä»“ä¸Šä¸‹æ–‡
â”‚       â”‚   â””â”€â”€ market_snapshots/         # å¸‚åœºå¿«ç…§ç›®å½•
â”‚       â”‚       â”œâ”€â”€ 20251119.csv          # âœ… ä»Šæ—¥å¿«ç…§
â”‚       â”‚       â”œâ”€â”€ 20251118.csv          # âœ… æ˜¨æ—¥å¿«ç…§
â”‚       â”‚       â””â”€â”€ 20251117.csv          # âœ… å‰æ—¥å¿«ç…§
â”‚       â”‚           ...                   # å…¶ä»–æ—¥æœŸ
â”‚       â””â”€â”€ qwen/                         # Qwenæ•°æ®ç›®å½•
â”‚           â””â”€â”€ (åŒdeepseekç»“æ„)
```

---

## ğŸ“‹ æ–‡ä»¶è¯´æ˜

### 1. trades_history.csv

**è·¯å¾„**: `trading_data/{model_name}/trades_history.csv`

**è¯´æ˜**: 
- åŒ…å«æ‰€æœ‰å†å²äº¤æ˜“è®°å½•
- **ä¸æ˜¯æŒ‰æ—¥æœŸåˆ†æ–‡ä»¶**ï¼Œè€Œæ˜¯å•ä¸ªæ–‡ä»¶æŒç»­è¿½åŠ 
- æ¯ç¬”äº¤æ˜“åŒ…å«å¼€ä»“å’Œå¹³ä»“ä¿¡æ¯

**å­—æ®µç¤ºä¾‹**ï¼ˆéƒ¨åˆ†ï¼‰ï¼š
```
å¸ç§, æ–¹å‘, å¼€ä»“æ—¶é—´, å¼€ä»“ä»·æ ¼, å¹³ä»“æ—¶é—´, å¹³ä»“ä»·æ ¼, ç›ˆäº(U), 
å…±æŒ¯æŒ‡æ ‡æ•°, indicator_consensus, ä¿¡å·åˆ†æ•°, signal_score, ...
```

**ä»£ç ä½ç½®**ï¼š
```python
# deepseek_å¤šå¸ç§æ™ºèƒ½ç‰ˆ.py ç¬¬749è¡Œ
TRADES_FILE = DATA_DIR / "trades_history.csv"
```

---

### 2. å¸‚åœºå¿«ç…§æ–‡ä»¶

**è·¯å¾„**: `trading_data/{model_name}/market_snapshots/{YYYYMMDD}.csv`

**è¯´æ˜**:
- æ¯å¤©ä¸€ä¸ªæ–‡ä»¶
- æ–‡ä»¶åæ ¼å¼ï¼š`YYYYMMDD.csv`ï¼ˆå¦‚ï¼š`20251118.csv`ï¼‰
- **ä¸æ˜¯** `kline_snapshots_20251118.csv` âŒ

**å­—æ®µç¤ºä¾‹**ï¼ˆéƒ¨åˆ†ï¼‰ï¼š
```
coin, time, open, high, low, close, volume,
trend_15m, trend_1h, trend_4h, 
indicator_consensus, signal_score,
ema20_1h, ema50_1h, ...
```

**ä»£ç ä½ç½®**ï¼š
```python
# deepseek_å¤šå¸ç§æ™ºèƒ½ç‰ˆ.py ç¬¬2645-2649è¡Œ
snapshot_dir = Path("trading_data") / model_name / "market_snapshots"
snapshot_dir.mkdir(parents=True, exist_ok=True)
today = datetime.now().strftime("%Y%m%d")
snapshot_file = snapshot_dir / f"{today}.csv"
```

---

### 3. learning_config.json

**è·¯å¾„**: `trading_data/{model_name}/learning_config.json`

**è¯´æ˜**: 
- å­˜å‚¨AIå­¦ä¹ çš„å‚æ•°é…ç½®
- åŒ…å«Phase 2/3/4çš„ä¼˜åŒ–ç»“æœ
- åŒ…å«ä¿¡å·åˆ†æƒé‡é…ç½®

**ç»“æ„ç¤ºä¾‹**ï¼š
```json
{
  "global": {
    "min_risk_reward": 2.5,
    "atr_stop_multiplier": 1.5,
    ...
  },
  "scalping_params": {
    "atr_tp_multiplier": 2.0,
    "max_holding_hours": 12,
    ...
  },
  "swing_params": {
    "atr_tp_multiplier": 6.0,
    "max_holding_hours": 72,
    ...
  },
  "signal_score_weights": {
    "scalping": {...},
    "swing": {...}
  },
  "_phase3_result": {...},
  "_phase4_validation": {...}
}
```

---

## ğŸ” å¸¸è§è¯¯åŒº

### âŒ é”™è¯¯çš„æ–‡ä»¶å

| é”™è¯¯ | æ­£ç¡® |
|------|------|
| `kline_snapshots_20251118.csv` | `20251118.csv` |
| `orders_20251118.csv` | `trades_history.csv` |
| `market_snapshots_20251118.csv` | `20251118.csv` |

### âŒ é”™è¯¯çš„å‡è®¾

1. **è®¢å•ä¸æ˜¯æŒ‰æ—¥æœŸåˆ†æ–‡ä»¶çš„**
   - âŒ æ¯å¤©ä¸€ä¸ªè®¢å•æ–‡ä»¶
   - âœ… å•ä¸ª`trades_history.csv`åŒ…å«æ‰€æœ‰å†å²

2. **å¸‚åœºå¿«ç…§æ–‡ä»¶åæ²¡æœ‰å‰ç¼€**
   - âŒ `kline_snapshots_{date}.csv`
   - âœ… `{date}.csv`

3. **CSVç¼–ç **
   - äº¤æ˜“å†å²ï¼š`utf-8-sig`ï¼ˆå¸¦BOMï¼‰
   - å¸‚åœºå¿«ç…§ï¼š`utf-8-sig`ï¼ˆå¸¦BOMï¼‰

---

## ğŸ“ å¦‚ä½•ç­›é€‰æ˜¨æ—¥æ•°æ®

### å¸‚åœºå¿«ç…§
```python
# ç›´æ¥è¯»å–æ˜¨æ—¥æ–‡ä»¶
yesterday = (datetime.now() - timedelta(days=1)).strftime("%Y%m%d")
snapshot_file = f"trading_data/deepseek/market_snapshots/{yesterday}.csv"
df = pd.read_csv(snapshot_file)
```

### äº¤æ˜“å†å²
```python
# ä»trades_history.csvä¸­ç­›é€‰
df = pd.read_csv('trading_data/deepseek/trades_history.csv', encoding='utf-8-sig')
yesterday = '2025-11-18'  # YYYY-MM-DDæ ¼å¼

# ç­›é€‰æ˜¨æ—¥å¼€ä»“æˆ–å¹³ä»“çš„äº¤æ˜“
yesterday_trades = df[
    (df['å¼€ä»“æ—¶é—´'].astype(str).str.contains(yesterday, na=False)) |
    (df['å¹³ä»“æ—¶é—´'].astype(str).str.contains(yesterday, na=False))
]
```

---

## ğŸ”§ è¯Šæ–­å·¥å…·ä½¿ç”¨

### check_consensus_data.py

**æ­£ç¡®ç”¨æ³•**ï¼ˆå·²ä¿®å¤ï¼‰ï¼š
```bash
cd ~/10-23-bot/ds
python3 check_consensus_data.py
```

**è¯¥è„šæœ¬ä¼šè‡ªåŠ¨**ï¼š
1. è¯»å– `trading_data/deepseek/market_snapshots/{yesterday}.csv`
2. è¯»å– `trading_data/deepseek/trades_history.csv`
3. ç­›é€‰æ˜¨æ—¥äº¤æ˜“
4. æ˜¾ç¤ºå…±æŒ¯æ•°æ®å’Œç»Ÿè®¡

---

## ğŸ¯ å¿«é€Ÿæ£€æŸ¥å‘½ä»¤

```bash
# 1. æ£€æŸ¥æ•°æ®ç›®å½•æ˜¯å¦å­˜åœ¨
ls -lh ~/10-23-bot/ds/trading_data/deepseek/

# 2. æ£€æŸ¥å¸‚åœºå¿«ç…§æ–‡ä»¶
ls -lh ~/10-23-bot/ds/trading_data/deepseek/market_snapshots/ | tail -5

# 3. æ£€æŸ¥äº¤æ˜“å†å²æ–‡ä»¶
ls -lh ~/10-23-bot/ds/trading_data/deepseek/trades_history.csv

# 4. æŸ¥çœ‹äº¤æ˜“å†å²è¡Œæ•°
wc -l ~/10-23-bot/ds/trading_data/deepseek/trades_history.csv

# 5. æŸ¥çœ‹æœ€æ–°å¸‚åœºå¿«ç…§
cd ~/10-23-bot/ds/trading_data/deepseek/market_snapshots
ls -t | head -1  # æ˜¾ç¤ºæœ€æ–°æ–‡ä»¶
```

---

## ğŸ“š ç›¸å…³ä»£ç ä½ç½®

| åŠŸèƒ½ | æ–‡ä»¶ | è¡Œå· |
|------|------|------|
| æ•°æ®ç›®å½•å®šä¹‰ | deepseek_å¤šå¸ç§æ™ºèƒ½ç‰ˆ.py | 747-751 |
| å¸‚åœºå¿«ç…§ä¿å­˜ | deepseek_å¤šå¸ç§æ™ºèƒ½ç‰ˆ.py | 2645-2649 |
| å¸‚åœºå¿«ç…§è¯»å– | deepseek_å¤šå¸ç§æ™ºèƒ½ç‰ˆ.py | 8944-8956 |
| äº¤æ˜“å†å²è¯»å– | deepseek_å¤šå¸ç§æ™ºèƒ½ç‰ˆ.py | 9041 |

---

**âœ… ç°åœ¨æ–‡ä»¶è·¯å¾„å·²æ˜ç¡®ï¼** ğŸ“‚

