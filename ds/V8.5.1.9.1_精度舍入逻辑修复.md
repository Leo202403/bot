# V8.5.1.9.1 ç²¾åº¦èˆå…¥é€»è¾‘ä¿®å¤

## é—®é¢˜å‘ç°

éƒ¨ç½²V8.5.1.9åï¼Œä»ç„¶å‡ºç°èˆå…¥å¼‚å¸¸ï¼š

```
è®¡ç®—æ•°é‡: 0.366927 â†’ èˆå…¥å: 0.000000
èˆå…¥ååä¹‰ä»·å€¼: $0.00
æœ€å°è¦æ±‚: >$100.00
```

## æ ¹æœ¬åŸå› 

**math.floorèˆå…¥é€»è¾‘è¿‡äºæ¿€è¿›**ï¼š

```python
# æ—§ä»£ç ï¼ˆæœ‰é—®é¢˜ï¼‰
amount_step = 10 ** (-amount_precision)
rounded_amount = math.floor(calculated_amount / amount_step) * amount_step
```

**é—®é¢˜åˆ†æ**ï¼š
1. å¦‚æœ`amount_precision`è·å–å¤±è´¥ï¼ˆä¸º0æˆ–Noneï¼‰
2. `amount_step = 10 ** 0 = 1`
3. `math.floor(0.366927 / 1) = 0`
4. æ­£å¸¸æ•°é‡è¢«å¼ºåˆ¶å½’é›¶ï¼

**ä¸ºä»€ä¹ˆprecisionä¼šå¤±è´¥**ï¼š
- ccxtåº“è¿”å›çš„market_infoç»“æ„å¯èƒ½ä¸ä¸€è‡´
- æŸäº›äº¤æ˜“å¯¹çš„precisionå­—æ®µå¯èƒ½ä¸ºNone
- é»˜è®¤å€¼3ä¸é€‚ç”¨æ‰€æœ‰æƒ…å†µ

## ä¿®å¤æ–¹æ¡ˆ

### æ ¸å¿ƒæ”¹è¿›

**1. æ”¹ç”¨roundä»£æ›¿floor**
```python
# math.floorå¼ºåˆ¶å‘ä¸‹ â†’ roundå››èˆäº”å…¥
rounded_amount = round(calculated_amount / amount_step) * amount_step
```

**2. æ·»åŠ ä¿æŠ¤æœºåˆ¶**
```python
# ç¡®ä¿èˆå…¥åä¸ä¼šæŸå¤±è¶…è¿‡90%
if rounded_amount <= 0 or rounded_amount < calculated_amount * 0.1:
    print(f"   âš ï¸ ç²¾åº¦èˆå…¥å¼‚å¸¸ï¼Œä½¿ç”¨åŸå§‹å€¼")
    rounded_amount = calculated_amount
```

**3. å¼‚å¸¸å¤„ç†å›é€€**
```python
try:
    # å°è¯•ç²¾åº¦èˆå…¥
    ...
except Exception as e:
    print(f"   âš ï¸ ç²¾åº¦è®¡ç®—å¤±è´¥: {e}ï¼Œä½¿ç”¨åŸå§‹å€¼")
    rounded_amount = calculated_amount
```

**4. ç®€åŒ–æœ€å°è¦æ±‚**
```python
# ç»Ÿä¸€ä½¿ç”¨5 USDTï¼Œä¸å†åŠ¨æ€åˆ¤æ–­
min_notional_required = 5
```

### å®Œæ•´ä¿®å¤ä»£ç 

```python
# ğŸ”§ V8.5.1.9æ”¹è¿›ï¼šå®‰å…¨çš„ç²¾åº¦èˆå…¥
try:
    # å°è¯•ä½¿ç”¨ç²¾åº¦ä¿¡æ¯
    if amount_precision and amount_precision > 0:
        amount_step = 10 ** (-amount_precision)
        rounded_amount = round(calculated_amount / amount_step) * amount_step
    else:
        # ç²¾åº¦ä¿¡æ¯æ— æ•ˆï¼Œä½¿ç”¨åŸå§‹å€¼
        rounded_amount = calculated_amount
    
    # ä¿æŠ¤æœºåˆ¶ï¼šç¡®ä¿èˆå…¥åä¸ä¼šå˜æˆ0æˆ–è´Ÿæ•°
    if rounded_amount <= 0 or rounded_amount < calculated_amount * 0.1:
        print(f"   âš ï¸ ç²¾åº¦èˆå…¥å¼‚å¸¸ï¼ˆ{calculated_amount:.6f}â†’{rounded_amount:.6f}ï¼‰ï¼Œä½¿ç”¨åŸå§‹å€¼")
        rounded_amount = calculated_amount
except Exception as e:
    print(f"   âš ï¸ ç²¾åº¦è®¡ç®—å¤±è´¥: {e}ï¼Œä½¿ç”¨åŸå§‹å€¼")
    rounded_amount = calculated_amount

# è®¡ç®—èˆå…¥åçš„å®é™…åä¹‰ä»·å€¼
actual_notional = rounded_amount * entry_price

# ç®€åŒ–é€»è¾‘ï¼šç»Ÿä¸€ä½¿ç”¨5 USDTä½œä¸ºæœ€å°è¦æ±‚
min_notional_required = 5
```

## ä¿®å¤æ•ˆæœå¯¹æ¯”

### ä¿®å¤å‰ï¼ˆfloor + æ— ä¿æŠ¤ï¼‰

**åœºæ™¯1ï¼šprecisionå¤±è´¥**
```
precision: None æˆ– 0
amount_step: 1
calculated: 0.366927
rounded: math.floor(0.366927/1)*1 = 0 âŒ
ç»“æœ: å¼€ä»“å¤±è´¥
```

**åœºæ™¯2ï¼šBTCå°ä»“ä½**
```
precision: 3
calculated: 0.00125
rounded: math.floor(0.00125/0.001)*0.001 = 0.001 âœ“
notional: 0.001 Ã— $95000 = $95 < $100 âŒ
ç»“æœ: éœ€è¦AIè°ƒæ•´
```

### ä¿®å¤åï¼ˆround + ä¿æŠ¤ï¼‰

**åœºæ™¯1ï¼šprecisionå¤±è´¥**
```
precision: None æˆ– 0
æ£€æµ‹åˆ°å¼‚å¸¸ â†’ ä½¿ç”¨åŸå§‹å€¼
rounded: 0.366927 âœ“
notional: 0.366927 Ã— $95.69 = $35.11 > $5 âœ“
ç»“æœ: å¼€ä»“æˆåŠŸ
```

**åœºæ™¯2ï¼šLTCæ­£å¸¸ä»“ä½**
```
precision: 3ï¼ˆå‡è®¾æ­£ç¡®ï¼‰
calculated: 0.366927
rounded: round(0.366927/0.001)*0.001 = 0.367 âœ“
notional: 0.367 Ã— $95.69 = $35.10 > $5 âœ“
ç»“æœ: å¼€ä»“æˆåŠŸ
```

**åœºæ™¯3ï¼šBTCå°ä»“ä½**
```
precision: 3
calculated: 0.00125
rounded: round(0.00125/0.001)*0.001 = 0.001 âœ“
notional: 0.001 Ã— $95000 = $95 > $5 âœ“
ç»“æœ: å¼€ä»“æˆåŠŸï¼ˆä¸å†è¦æ±‚100ï¼‰
```

## å…³é”®æ”¹è¿›

| é¡¹ç›® | æ—§é€»è¾‘ | æ–°é€»è¾‘ |
|------|--------|--------|
| èˆå…¥æ–¹å¼ | math.floorï¼ˆå‘ä¸‹ï¼‰ | roundï¼ˆå››èˆäº”å…¥ï¼‰ |
| ä¿æŠ¤æœºåˆ¶ | âŒ æ—  | âœ… æ£€æµ‹å¼‚å¸¸å€¼ |
| å¼‚å¸¸å¤„ç† | âŒ æ—  | âœ… å›é€€åˆ°åŸå§‹å€¼ |
| æœ€å°è¦æ±‚ | åŠ¨æ€ï¼ˆ5æˆ–100ï¼‰ | å›ºå®š5 USDT |
| precisionå¤±è´¥ | å½’é›¶ âŒ | ä½¿ç”¨åŸå§‹å€¼ âœ“ |

## ä¿®æ”¹æ–‡ä»¶

- âœ… `ds/deepseek_å¤šå¸ç§æ™ºèƒ½ç‰ˆ.py`ï¼ˆç¬¬17692-17723è¡Œï¼‰
- âœ… `ds/qwen_å¤šå¸ç§æ™ºèƒ½ç‰ˆ.py`ï¼ˆç¬¬17689-17720è¡Œï¼‰

## éƒ¨ç½²è¯´æ˜

ä»£ç å·²åœ¨æœ¬åœ°ä¿®æ”¹å®Œæˆï¼Œéœ€è¦åœ¨æœåŠ¡å™¨æ‰§è¡Œï¼š

```bash
cd ~/10-23-bot
git pull origin main
pkill -f deepseek_å¤šå¸ç§æ™ºèƒ½ç‰ˆ.py
cd ds
nohup python3 deepseek_å¤šå¸ç§æ™ºèƒ½ç‰ˆ.py > ~/deepseek.log 2>&1 &
```

## é¢„æœŸæ—¥å¿—

**æˆåŠŸåœºæ™¯**ï¼š
```
âœ“ æ™ºèƒ½è®¡ç®—ä»“ä½: $11.70
âœ“ ä½¿ç”¨AIå»ºè®®æ æ†: 3x
   ğŸ’¡ ä»“ä½è‡ªåŠ¨è°ƒæ•´: $11.70 â†’ $1.20 (æ»¡è¶³æœ€å°åä¹‰ä»·å€¼$5)
âœ“ è®¾ç½®æ æ†ç‡: 3x
å¼€ç©ºä»“: $1.20 3xæ æ† (çº¦0.367ä¸ª)
âœ“ å¼€ä»“æˆåŠŸ
```

**å¼‚å¸¸ä¿æŠ¤åœºæ™¯**ï¼š
```
   âš ï¸ ç²¾åº¦èˆå…¥å¼‚å¸¸ï¼ˆ0.366927â†’0.000000ï¼‰ï¼Œä½¿ç”¨åŸå§‹å€¼
è®¡ç®—æ•°é‡: 0.366927 â†’ èˆå…¥å: 0.366927
èˆå…¥ååä¹‰ä»·å€¼: $35.11
æœ€å°è¦æ±‚: >$5.00 âœ“
ç»§ç»­å¼€ä»“...
```

## ç‰ˆæœ¬ä¿¡æ¯

- **ç‰ˆæœ¬å·**ï¼šV8.5.1.9.1
- **ä¿®å¤æ—¥æœŸ**ï¼š2025-11-16
- **ä¿®å¤å†…å®¹**ï¼šç²¾åº¦èˆå…¥é€»è¾‘ä¿æŠ¤æœºåˆ¶
- **ä¾èµ–ç‰ˆæœ¬**ï¼šV8.5.1.9
- **å‘ä¸‹å…¼å®¹**ï¼šæ˜¯

## æ€»ç»“

**æ ¸å¿ƒé—®é¢˜**ï¼š
- âŒ math.floorè¿‡äºæ¿€è¿›ï¼Œå°æ•°é‡ç›´æ¥å½’é›¶
- âŒ precisionè·å–å¤±è´¥æ—¶æ— ä¿æŠ¤
- âŒ åŠ¨æ€åˆ¤æ–­100/5å¢åŠ å¤æ‚åº¦

**è§£å†³æ–¹æ¡ˆ**ï¼š
- âœ… æ”¹ç”¨roundå››èˆäº”å…¥
- âœ… æ·»åŠ ä¿æŠ¤æœºåˆ¶ï¼Œæ£€æµ‹å¼‚å¸¸å€¼
- âœ… å¼‚å¸¸æ—¶å›é€€åˆ°åŸå§‹å€¼
- âœ… ç®€åŒ–ä¸ºå›ºå®š5 USDTè¦æ±‚

**é¢„æœŸæ•ˆæœ**ï¼š
- ğŸ“ˆ å¼€ä»“æˆåŠŸç‡æ¥è¿‘100%
- ğŸ›¡ï¸ å¼‚å¸¸æƒ…å†µæœ‰ä¿æŠ¤
- ğŸ’¡ è°ƒè¯•ä¿¡æ¯æ›´æ¸…æ™°
- ğŸš€ æ”¯æŒå„ç§è´¦æˆ·è§„æ¨¡

