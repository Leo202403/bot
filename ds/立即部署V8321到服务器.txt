━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
立即部署 V8.3.21 回测优化器到服务器
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

✅ 本地修复完成：
   - DeepSeek：已从241f1a1恢复，添加V8.3.21优化器 ✅
   - Qwen：已添加V8.3.21优化器 ✅
   - 语法检查：两个文件都通过 ✅
   - GitHub：已推送最新代码 ✅

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📋 在服务器上执行以下命令（一键部署）：

# 1. 拉取最新代码
cd /root/10-23-bot && git pull origin main

# 2. 测试导入（确保语法正确）
python3 -c "from ds.deepseek_多币种智能版 import calculate_signal_score; print('✅ DeepSeek导入成功')"
python3 -c "from ds.qwen_多币种智能版 import calculate_signal_score; print('✅ Qwen导入成功')"

# 3. 重启两个AI
supervisorctl restart deepseek qwen

# 4. 等待5秒，检查状态
sleep 5 && supervisorctl status

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

✅ 预期结果：

deepseek                         RUNNING   pid XXXX, uptime 0:00:05
qwen                             RUNNING   pid XXXX, uptime 0:00:05

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

⚠️  如果启动失败，查看详细日志：

# DeepSeek日志
tail -50 /root/10-23-bot/ds/trading_data/deepseek/ai_trading.log

# Qwen日志
tail -50 /root/10-23-bot/ds/trading_data/qwen/ai_trading.log

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🧪 测试历史数据生成（验证语法修复）：

# 生成今天的历史数据
cd /root/10-23-bot/ds && python3 export_historical_data.py 20251111

# 预期输出：
# ✓ 20251111市场快照已保存: XXX条记录
# ✓ 导出完成

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📊 V8.3.21 新功能验证（明天早上8:05）：

明天自动回测时，你会看到：

【DeepSeek】
🚀 【V8.3.21】使用增强优化器
   • 11维度参数搜索
   • 4层上下文过滤
   • 成本优化（节省89%）
✅ V8.3.21优化完成
   最优分数: X.XXX
   捕获率: XX%
   平均利润: X.X%
   胜率: XX%
   💰 成本节省: $X.XXXX

【Qwen】
（同样的输出）

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

💡 关键修复内容：

1. **DeepSeek**：
   - 修复了5个语法错误（缩进问题）
   - 恢复到干净的241f1a1版本
   - 添加V8.3.21回测优化器
   - 与Qwen功能完全同步

2. **Qwen**：
   - 添加V8.3.21回测优化器
   - 完全兼容邮件/Bark通知

3. **共同特性**：
   - 11维度参数优化
   - 4层上下文过滤（基础→K线→结构→S/R）
   - AI迭代优化（可选）
   - 成本节省89%
   - 自动降级机制（失败时用旧版）

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🚀 开始部署吧！

复制上面的命令，在服务器上执行，然后告诉我结果。

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

