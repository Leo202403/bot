======================================================================
ğŸ”§ V8.3.11 å…³é”®ä¿®å¤ - å®é™…äº¤æ˜“æ­£ç¡®è¯»å– V8.3.4 åˆ†ç¦»ç­–ç•¥å‚æ•°
======================================================================
â° ä¿®å¤æ—¶é—´: 2025-11-07 18:00
ğŸ¯ é—®é¢˜: å›æµ‹ä¼˜åŒ–çš„separated paramsæœªè¢«å®é™…äº¤æ˜“ä½¿ç”¨
ğŸ“Š å½±å“: å®é™…è¦æ±‚ä»ä½¿ç”¨globalå‚æ•°(2.0) Ã— 1.3 = 2.6ï¼Œè€Œéä¼˜åŒ–åçš„1.5

======================================================================
ã€é—®é¢˜è¯Šæ–­ã€‘
======================================================================

âŒ å½“å‰æƒ…å†µï¼ˆç”¨æˆ·åé¦ˆï¼‰ï¼š
  ğŸ“§ é‚®ä»¶æ˜¾ç¤º: æ³¢æ®µæœ€å°ç›ˆäºæ¯” 2.0
  ğŸ“± Barké€šçŸ¥: å®é™…è¦æ±‚ 2.6 (= 2.0 Ã— high_riskä¹˜æ•°1.3)
  ğŸ“Š V7.7.0ä¼˜åŒ–ç»“æœ: 1.5 (æœªè¢«ä½¿ç”¨ï¼)

ğŸ” æ ¹æœ¬åŸå› ï¼š
  1. V7.7.0ä¼˜åŒ–åä¿å­˜åˆ° config["global"]["min_risk_reward"] = 1.5
  2. V8.3.4ä¼˜åŒ–ååº”ä¿å­˜åˆ° config["swing_params"]["min_risk_reward"] = X
  3. å®é™…å¼€ä»“æ—¶ get_learning_config_for_symbol() ä» config["global"] è¯»å–
  4. æ²¡æœ‰åŒºåˆ† signal_typeï¼Œå¯¼è‡´è¯»å–äº†é”™è¯¯çš„åŸºå‡†å€¼ï¼

ğŸ¯ å…³é”®ä»£ç ä½ç½®ï¼š
  1. get_learning_config_for_symbol() (ç¬¬3577è¡Œ) - å¼€ä»“å†³ç­–æ—¶è¯»å–å‚æ•°
  2. calculate_unified_risk_reward_v2() (ç¬¬10503è¡Œ) - è®¡ç®—TP/SLæ—¶è¯»å–å‚æ•°

======================================================================
ã€V8.3.11 ä¿®å¤å†…å®¹ã€‘
======================================================================

ğŸ“ æ–‡ä»¶: qwen_å¤šå¸ç§æ™ºèƒ½ç‰ˆ.py + deepseek_å¤šå¸ç§æ™ºèƒ½ç‰ˆ.py

ğŸ”§ ä¿®å¤1: get_learning_config_for_symbol å‡½æ•°ï¼ˆç¬¬3577-3664è¡Œï¼‰
---
ğŸ“Œ æ–°å¢å‚æ•°: signal_type='swing'

BEFORE (ç¬¬3618-3619è¡Œ):
    ai_base_rr = config["global"].get("min_risk_reward", 1.5)
    ai_base_score = config["global"].get("min_signal_score", 55)

AFTER:
    # ã€V8.3.11ã€‘ä¼˜å…ˆä½¿ç”¨separated paramsï¼Œå¦åˆ™fallbackåˆ°global
    if signal_type == 'scalping':
        strategy_params = config.get('scalping_params', {})
        default_rr = 1.3
        default_score = 50
    else:
        strategy_params = config.get('swing_params', {})
        default_rr = 2.0
        default_score = 60
    
    ai_base_rr = strategy_params.get('min_risk_reward') or config["global"].get("min_risk_reward", default_rr)
    ai_base_score = strategy_params.get('min_signal_score') or config["global"].get("min_signal_score", default_score)

ğŸ”§ ä¿®å¤2: calculate_unified_risk_reward_v2 å‡½æ•°ï¼ˆç¬¬10503-10534è¡Œï¼‰
---
BEFORE (ç¬¬10522-10524è¡Œ):
    if min_rr is None:
        # Scalpingè¦æ±‚æ›´ä½çš„R:Rï¼ˆ1.5:1ï¼‰ï¼ŒSwingè¦æ±‚æ›´é«˜ï¼ˆ2.5:1ï¼‰
        min_rr = 1.5 if signal_type == 'scalping' else config.get("min_risk_reward", 2.5)

AFTER:
    if min_rr is None:
        # ã€V8.3.11ã€‘ä¼˜å…ˆä½¿ç”¨separated params
        if signal_type == 'scalping':
            min_rr = config.get('scalping_params', {}).get('min_risk_reward') or config.get("global", {}).get("min_risk_reward", 1.3)
        else:
            min_rr = config.get('swing_params', {}).get('min_risk_reward') or config.get("global", {}).get("min_risk_reward", 2.0)

ğŸ”§ ä¿®å¤3: è°ƒç”¨ get_learning_config_for_symbol çš„åœ°æ–¹éœ€ä¼ å…¥ signal_type
---
éœ€è¦æ£€æŸ¥æ‰€æœ‰è°ƒç”¨è¯¥å‡½æ•°çš„åœ°æ–¹ï¼Œç¡®ä¿ä¼ å…¥æ­£ç¡®çš„signal_typeå‚æ•°

======================================================================
ã€ä¿®å¤åçš„æµç¨‹ã€‘
======================================================================

âœ… æ­£ç¡®æµç¨‹ï¼š
  1ï¸âƒ£ V7.7.0ä¼˜åŒ–: ä¿å­˜åˆ°config["global"]["min_risk_reward"] = 1.5
  2ï¸âƒ£ V8.3.4ä¼˜åŒ–: ä¿å­˜åˆ°config["scalping_params"]["min_risk_reward"] = X
                ä¿å­˜åˆ°config["swing_params"]["min_risk_reward"] = Y
  3ï¸âƒ£ å®é™…å¼€ä»“ï¼ˆScalpingä¿¡å·ï¼‰:
     - get_learning_config_for_symbol(symbol, config, signal_type='scalping')
     - è¯»å– config["scalping_params"]["min_risk_reward"]
     - å¦‚æœä¸å­˜åœ¨ï¼Œfallbackåˆ° config["global"]["min_risk_reward"]
  4ï¸âƒ£ å®é™…å¼€ä»“ï¼ˆSwingä¿¡å·ï¼‰:
     - get_learning_config_for_symbol(symbol, config, signal_type='swing')
     - è¯»å– config["swing_params"]["min_risk_reward"]
     - å¦‚æœä¸å­˜åœ¨ï¼Œfallbackåˆ° config["global"]["min_risk_reward"]

======================================================================
ã€ç«‹å³éƒ¨ç½²ã€‘âœ… ä»£ç å·²ä¿®å¤å®Œæˆ
======================================================================

# 1. ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼ˆæœ¬åœ°æ–‡ä»¶å·²ä¿®å¤ï¼‰
cd /Users/mac-bauyu/Downloads/10-23-bot/ds
scp qwen_å¤šå¸ç§æ™ºèƒ½ç‰ˆ.py deepseek_å¤šå¸ç§æ™ºèƒ½ç‰ˆ.py admin@æœåŠ¡å™¨IP:~/10-23-bot/ds/

# 2. SSHåˆ°æœåŠ¡å™¨
ssh admin@æœåŠ¡å™¨IP

# 3. éªŒè¯è¯­æ³•
cd ~/10-23-bot/ds
python3 -m py_compile qwen_å¤šå¸ç§æ™ºèƒ½ç‰ˆ.py deepseek_å¤šå¸ç§æ™ºèƒ½ç‰ˆ.py

# 4. é‡æ–°è¿è¡Œå›æµ‹
cd ~
bash å¿«é€Ÿé‡å¯_ä¿®å¤ç‰ˆ.sh backtest-deepseek

======================================================================
ã€éªŒè¯ä¿®å¤æ•ˆæœã€‘
======================================================================

âœ… ä¿®å¤æˆåŠŸæ ‡å¿—ï¼š
  1. å›æµ‹å®Œæˆåï¼ŒV8.3.4æˆåŠŸæ‰§è¡Œï¼ˆä¸å†æŠ¥Seriesé”™è¯¯ï¼‰
  2. learning_config.jsonåŒ…å«æ­£ç¡®çš„separated params
  3. Barké€šçŸ¥æ˜¾ç¤ºçš„è¦æ±‚ä¸ä¼˜åŒ–åçš„å‚æ•°ä¸€è‡´

ğŸ“Š é¢„æœŸç»“æœï¼ˆå‡è®¾V8.3.4ä¼˜åŒ–swingä¸º1.8ï¼‰ï¼š
  - Swingä¿¡å·è¦æ±‚: 1.8 Ã— 1.3 (high_risk) = 2.34
  - è€Œä¸æ˜¯: 2.0 Ã— 1.3 = 2.6

======================================================================
âœ… V8.3.11 ä¿®å¤æ–¹æ¡ˆå·²åˆ¶å®šï¼
======================================================================

