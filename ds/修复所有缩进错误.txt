======================================================================
🔧 批量修复缩进错误脚本
======================================================================

用户误删代码时IDE自动调整了大量缩进，导致数十处缩进错误。

手动一个个修复太慢，建议用以下方案：

======================================================================
【方案1：重新下载完整文件（推荐）】
======================================================================

从GitHub或备份恢复V8.3.11+V8.3.10.3完整版本：

1. 如果有git仓库：
   ```bash
   cd ~/10-23-bot/ds
   git stash  # 保存当前更改
   git checkout HEAD -- qwen_多币种智能版.py deepseek_多币种智能版.py
   ```

2. 或者让我重新生成完整文件（约18000行）

======================================================================
【方案2：Python脚本自动修复缩进】
======================================================================

创建 fix_indentation.py：

```python
import re

def fix_common_indentation_errors(filepath):
    with open(filepath, 'r', encoding='utf-8') as f:
        lines = f.readlines()
    
    fixed_lines = []
    i = 0
    while i < len(lines):
        line = lines[i]
        
        # 检测常见的缩进错误模式
        # 1. try: 后面的内容没有缩进
        if line.strip().startswith('try:') and i + 1 < len(lines):
            fixed_lines.append(line)
            i += 1
            # 检查下一行是否需要额外缩进
            next_line = lines[i]
            if not next_line.strip().startswith(('#', 'except', 'finally')) and next_line.strip():
                # 计算当前缩进
                current_indent = len(line) - len(line.lstrip())
                next_indent = len(next_line) - len(next_line.lstrip())
                if next_indent <= current_indent:
                    # 需要增加缩进
                    fixed_lines.append('    ' + next_line.lstrip())
                    i += 1
                    continue
        
        # 2. if/elif/else: 后面的内容没有缩进
        if re.match(r'\s*(if|elif|else|for|while|with)\s+.*:', line.strip()) and i + 1 < len(lines):
            fixed_lines.append(line)
            i += 1
            next_line = lines[i]
            if next_line.strip() and not next_line.strip().startswith('#'):
                current_indent = len(line) - len(line.lstrip())
                next_indent = len(next_line) - len(next_line.lstrip())
                if next_indent <= current_indent:
                    # 需要增加缩进
                    fixed_lines.append('    ' + next_line.lstrip())
                    i += 1
                    continue
        
        fixed_lines.append(line)
        i += 1
    
    # 写回文件
    with open(filepath, 'w', encoding='utf-8') as f:
        f.writelines(fixed_lines)

# 使用
fix_common_indentation_errors('qwen_多币种智能版.py')
fix_common_indentation_errors('deepseek_多币种智能版.py')
```

运行：
```bash
cd ~/10-23-bot/ds
python3 fix_indentation.py
```

======================================================================
【方案3：使用IDE自动格式化】
======================================================================

如果使用VSCode/PyCharm：

1. 安装Python扩展
2. 打开文件
3. 右键 → Format Document (或按 Shift+Alt+F)
4. IDE会自动修复大部分缩进错误

⚠️ 注意：自动格式化可能改变某些有意的缩进，需要检查

======================================================================
【方案4：手动定位修复（当前进行中）】
======================================================================

当前已修复的错误：
✅ 第1208行: try块缩进
✅ 第1500行: try块中print缩进  
✅ 第2374行: if块中语句缩进
❌ 第10877行: elif块缩进 ← 当前错误

剩余约30+处缩进错误...

这个方案太慢，不建议继续。

======================================================================
【推荐操作】
======================================================================

**最快方案**：让我重新生成完整文件

优点：
- 包含所有V8.3.10.3+V8.3.11修复
- 没有缩进错误
- 保留所有功能

缺点：
- 需要重新上传（约2MB文件）
- 会覆盖用户的其他修改（如果有）

**您想选择哪个方案？**
1. 我重新生成完整文件（推荐）
2. 继续手动修复剩余30+处错误（耗时）
3. 使用Python脚本自动修复（可能不完美）

