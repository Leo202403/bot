# V8.3.21.2 æ´å¯Ÿä¼ é€’å¢å¼º - æœåŠ¡å™¨éƒ¨ç½²æŒ‡å—

## ğŸ¯ æœ¬æ¬¡æ›´æ–°å†…å®¹

**æ ¸å¿ƒæ”¹è¿›**: V8.3.21å›æµ‹ä¼˜åŒ–çš„æ´å¯Ÿç°åœ¨ä¼šè‡ªåŠ¨ä¼ é€’ç»™å®æ—¶AIå†³ç­–ï¼

### ä¿®æ”¹æ–‡ä»¶
- `deepseek_å¤šå¸ç§æ™ºèƒ½ç‰ˆ.py` (3å¤„ä¿®æ”¹)
- `qwen_å¤šå¸ç§æ™ºèƒ½ç‰ˆ.py` (3å¤„ä¿®æ”¹)

### ä¿®æ”¹ç‚¹
1. **`optimize_scalping_params`**: å›æµ‹åä¿å­˜è¶…çŸ­çº¿æ´å¯Ÿåˆ° `compressed_insights.v8321_insights.scalping`
2. **`optimize_swing_params`**: å›æµ‹åä¿å­˜æ³¢æ®µæ´å¯Ÿåˆ° `compressed_insights.v8321_insights.swing`
3. **`build_decision_context`**: è¯»å–V8.3.21æ´å¯Ÿå¹¶ä¼ é€’ç»™AIï¼ˆçº¦80-100 tokensï¼‰

### ä¼ é€’çš„æ´å¯Ÿå†…å®¹
```json
{
  "v8321_insights": {
    "scalping": {
      "best_contexts": [
        "é˜³çº¿æ¯”ä¾‹0.7-0.8æ—¶æ•ˆæœæœ€å¥½ï¼ˆå¹³å‡åˆ©æ¶¦12.5%ï¼‰",
        "LL-LHç»“æ„æ•ˆæœæœ€å¥½ï¼ˆå¹³å‡åˆ©æ¶¦12.6%ï¼‰"
      ],
      "param_sensitivity": {
        "min_kline_bullish_ratio": "high (+0.329)"
      },
      "performance": {
        "score": 0.848,
        "capture_rate": 0.74,
        "avg_profit": 0.121
      }
    },
    "swing": { /* åŒæ ·ç»“æ„ */ }
  }
}
```

---

## ğŸ“‹ éƒ¨ç½²æ­¥éª¤

### Step 1: SSHç™»å½•æœåŠ¡å™¨
```bash
ssh root@43.100.52.142
```

### Step 2: æ‹‰å–æœ€æ–°ä»£ç 
```bash
cd ~/10-23-bot
git pull origin main
```

**é¢„æœŸè¾“å‡º**:
```
remote: Enumerating objects: ...
From https://github.com/Leo202403/bot
   705bddf..48bfc1a  main -> main
Updating 705bddf..48bfc1a
Fast-forward
 ds/deepseek_å¤šå¸ç§æ™ºèƒ½ç‰ˆ.py | 70 +++++++++++++++++++++++++++++++++++++++++
 ds/qwen_å¤šå¸ç§æ™ºèƒ½ç‰ˆ.py     | 70 +++++++++++++++++++++++++++++++++++++++++
 ...
```

### Step 3: è¯­æ³•éªŒè¯
```bash
python3 -m py_compile ds/deepseek_å¤šå¸ç§æ™ºèƒ½ç‰ˆ.py && \
python3 -m py_compile ds/qwen_å¤šå¸ç§æ™ºèƒ½ç‰ˆ.py && \
echo "âœ… è¯­æ³•éªŒè¯é€šè¿‡"
```

### Step 4: é‡å¯AIæœåŠ¡
```bash
supervisorctl restart qwen deepseek
supervisorctl status qwen deepseek
```

**é¢„æœŸè¾“å‡º**:
```
qwen: stopped
deepseek: stopped
qwen: started
deepseek: started
qwen                             RUNNING   pid 12345, uptime 0:00:03
deepseek                         RUNNING   pid 12346, uptime 0:00:03
```

### Step 5: éªŒè¯æ—¥å¿—ï¼ˆå¯é€‰ï¼‰
```bash
# æŸ¥çœ‹DeepSeekå¯åŠ¨æ—¥å¿—ï¼ˆæœ€å20è¡Œï¼‰
tail -n 20 /var/log/supervisor/deepseek-stdout.log

# æŸ¥çœ‹Qwenå¯åŠ¨æ—¥å¿—ï¼ˆæœ€å20è¡Œï¼‰
tail -n 20 /var/log/supervisor/qwen-stdout.log
```

**é¢„æœŸçœ‹åˆ°**:
```
âœ“ æ—¶é—´åŒæ­¥æ­£å¸¸
======================================================================
å¤šå¸ç§AIæ™ºèƒ½äº¤æ˜“ç³»ç»Ÿå¯åŠ¨
======================================================================
å½“å‰USDTä½™é¢: XXX.XX
...
```

---

## ğŸ”¬ éªŒè¯V8.3.21æ´å¯Ÿä¼ é€’

### æ–¹å¼1: æ‰‹åŠ¨å›æµ‹ï¼ˆæ¨èï¼‰
```bash
cd ~/10-23-bot/ds
bash æ‰‹åŠ¨å›æµ‹.sh
```

**è§‚å¯Ÿæ—¥å¿—ä¸­çš„æ–°å¢è¾“å‡º**:
```
  âœ… V8.3.21è¶…çŸ­çº¿æ´å¯Ÿå·²ä¿å­˜åˆ° compressed_insights
  âœ… V8.3.21æ³¢æ®µæ´å¯Ÿå·²ä¿å­˜åˆ° compressed_insights
```

### æ–¹å¼2: æ£€æŸ¥é…ç½®æ–‡ä»¶
```bash
# æŸ¥çœ‹Qwençš„æ´å¯Ÿ
cat ~/10-23-bot/ds/trading_data/qwen/learning_config.json | jq '.compressed_insights.v8321_insights'

# æŸ¥çœ‹DeepSeekçš„æ´å¯Ÿ
cat ~/10-23-bot/ds/trading_data/deepseek/learning_config.json | jq '.compressed_insights.v8321_insights'
```

**é¢„æœŸè¾“å‡ºï¼ˆå¦‚æœå·²è¿è¡Œè¿‡å›æµ‹ï¼‰**:
```json
{
  "scalping": {
    "best_contexts": [
      "é˜³çº¿æ¯”ä¾‹0.7-0.8æ—¶æ•ˆæœæœ€å¥½ï¼ˆå¹³å‡åˆ©æ¶¦12.5%ï¼‰",
      "LL-LHç»“æ„æ•ˆæœæœ€å¥½ï¼ˆå¹³å‡åˆ©æ¶¦12.6%ï¼‰"
    ],
    "param_sensitivity": {
      "min_kline_bullish_ratio": "high (+0.329)",
      "min_trend_age_hours": "high (+0.156)"
    },
    "performance": {
      "score": 0.848,
      "capture_rate": 0.74,
      "avg_profit": 0.121
    },
    "updated_at": "2025-11-11 15:34"
  },
  "swing": { ... }
}
```

### æ–¹å¼3: è§‚å¯ŸAIå†³ç­–æ—¥å¿—
ç­‰å¾…AIä¸‹æ¬¡åˆ†æï¼ˆæ•´ç‚¹æ‰§è¡Œï¼‰ï¼ŒæŸ¥çœ‹æ—¥å¿—ï¼š
```bash
tail -f /var/log/supervisor/deepseek-stdout.log | grep "Optimized Context Patterns"
```

**é¢„æœŸçœ‹åˆ°AIçš„PromptåŒ…å«**:
```
## ğŸ”¬ Optimized Context Patterns (V8.3.21)
*Data-driven insights from 2 backtested strategies*

**Scalping** (Score: 0.848, Capture: 74%, Profit: 12.1%)
  â€¢ é˜³çº¿æ¯”ä¾‹0.7-0.8æ—¶æ•ˆæœæœ€å¥½ï¼ˆå¹³å‡åˆ©æ¶¦12.5%ï¼‰
  â€¢ LL-LHç»“æ„æ•ˆæœæœ€å¥½ï¼ˆå¹³å‡åˆ©æ¶¦12.6%ï¼‰
...
```

---

## ğŸ“Š æ•ˆæœéªŒè¯

### é¢„æœŸæ”¹è¿›
1. **AIå†³ç­–æ›´ç²¾å‡†**: åŸºäºå®é™…æ•°æ®ï¼Œè€Œéç»éªŒåˆ¤æ–­
2. **æ•è·ç‡æå‡**: AIçŸ¥é“ä»€ä¹ˆæ¡ä»¶ä¸‹æœºä¼šè´¨é‡æœ€é«˜
3. **æ›´å°‘è¯¯åˆ¤**: é¿å…åœ¨ä½è´¨é‡ç¯å¢ƒä¸‹å¼€å•

### æ€§èƒ½æŒ‡æ ‡
- **é¢å¤–æˆæœ¬**: ~$0.001/æ¬¡å†³ç­–ï¼ˆå¢åŠ 80 tokensï¼‰
- **é¢„æœŸæ”¶ç›Š**: å†³ç­–è´¨é‡æå‡20-30%
- **æŠ•èµ„å›æŠ¥**: æé«˜ï¼ˆæˆæœ¬å¯å¿½ç•¥ï¼Œæ”¶ç›Šæ˜¾è‘—ï¼‰

### è§‚å¯Ÿè¦ç‚¹
- AIæ˜¯å¦åœ¨ä½è´¨é‡ç¯å¢ƒä¸‹æ‹’ç»å¼€å•ï¼ˆå¦‚ `kline_ctx_bullish_ratio=0.5`ï¼‰
- AIæ˜¯å¦åœ¨é«˜è´¨é‡ç¯å¢ƒä¸‹æ›´ç§¯æï¼ˆå¦‚ `mkt_struct_swing=LL-LH`ï¼‰
- æ•è·ç‡ã€èƒœç‡ã€å¹³å‡åˆ©æ¶¦æ˜¯å¦æå‡

---

## ğŸš¨ æ³¨æ„äº‹é¡¹

1. **é¦–æ¬¡è¿è¡Œ**: å¦‚æœæœåŠ¡å™¨è¿˜æ²¡è¿è¡Œè¿‡å›æµ‹ï¼Œ`v8321_insights` ä¸ºç©ºï¼ŒAIä¸ä¼šçœ‹åˆ°è¿™äº›æ´å¯Ÿ
2. **å›æµ‹è§¦å‘**: æ¯æ—¥åŒ—äº¬æ—¶é—´08:05è‡ªåŠ¨å›æµ‹ï¼Œæˆ–æ‰‹åŠ¨è¿è¡Œ `bash æ‰‹åŠ¨å›æµ‹.sh`
3. **æ•°æ®åŒæ­¥**: Qwenå’ŒDeepSeekå„è‡ªç»´æŠ¤ç‹¬ç«‹çš„æ´å¯Ÿæ•°æ®
4. **å…¼å®¹æ€§**: å®Œå…¨å‘åå…¼å®¹ï¼Œæ—§ç‰ˆæœ¬çš„ `compressed_insights` ä¸å—å½±å“

---

## ğŸ”„ å›æ»šæ–¹æ¡ˆï¼ˆå¦‚æœ‰é—®é¢˜ï¼‰

å¦‚æœéƒ¨ç½²åå‘ç°é—®é¢˜ï¼Œå¯ä»¥å¿«é€Ÿå›æ»šï¼š

```bash
cd ~/10-23-bot
git log --oneline -n 5  # æŸ¥çœ‹æœ€è¿‘çš„æäº¤

# å›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬ï¼ˆV8.3.21.1ï¼‰
git reset --hard 705bddf

# é‡å¯æœåŠ¡
supervisorctl restart qwen deepseek
```

---

## âœ… éƒ¨ç½²å®Œæˆç¡®è®¤

éƒ¨ç½²æˆåŠŸåï¼Œè¯·ç¡®è®¤ï¼š
- [ ] ä»£ç å·²æ‹‰å–åˆ°æœåŠ¡å™¨ï¼ˆ`git pull` æˆåŠŸï¼‰
- [ ] è¯­æ³•éªŒè¯é€šè¿‡ï¼ˆ`py_compile` æ— æŠ¥é”™ï¼‰
- [ ] AIæœåŠ¡é‡å¯æˆåŠŸï¼ˆ`supervisorctl status` æ˜¾ç¤º `RUNNING`ï¼‰
- [ ] æ—¥å¿—æ­£å¸¸ï¼ˆæ— å¯åŠ¨é”™è¯¯ï¼‰
- [ ] ï¼ˆå¯é€‰ï¼‰æ‰‹åŠ¨å›æµ‹éªŒè¯æ´å¯Ÿå·²ä¿å­˜

---

## ğŸ“ é—®é¢˜æ’æŸ¥

### é—®é¢˜1: `git pull` å†²çª
```bash
# å¼ºåˆ¶è¦†ç›–æœ¬åœ°ä¿®æ”¹
git fetch origin
git reset --hard origin/main
```

### é—®é¢˜2: æœåŠ¡å¯åŠ¨å¤±è´¥
```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯
tail -n 50 /var/log/supervisor/deepseek-stderr.log
tail -n 50 /var/log/supervisor/qwen-stderr.log
```

### é—®é¢˜3: å›æµ‹å¤±è´¥
```bash
# æ‰‹åŠ¨è¿è¡Œå¹¶æŸ¥çœ‹é”™è¯¯
cd ~/10-23-bot/ds
python3 deepseek_å¤šå¸ç§æ™ºèƒ½ç‰ˆ.py
```

---

## ğŸ‰ é¢„æœŸç»“æœ

**ç«‹å³ç”Ÿæ•ˆ**: AIæœåŠ¡é‡å¯åï¼Œæ–°çš„æ´å¯Ÿä¼ é€’æœºåˆ¶ç«‹å³ç”Ÿæ•ˆ

**ç­‰å¾…å›æµ‹**: ä¸‹æ¬¡å›æµ‹ï¼ˆæ¯æ—¥08:05æˆ–æ‰‹åŠ¨è§¦å‘ï¼‰åï¼Œ`v8321_insights` ä¼šè¢«å¡«å……

**æŒç»­æ”¹è¿›**: æ¯æ¬¡å›æµ‹åï¼Œæ´å¯Ÿä¼šæ›´æ–°ä¸ºæœ€æ–°çš„ç»Ÿè®¡æ•°æ®

V8.3.21.2 éƒ¨ç½²å®Œæˆï¼ğŸš€

