# ğŸ” æœºä¼šåˆ†æé€»è¾‘é—®é¢˜è¯Šæ–­æŠ¥å‘Š

## ğŸ“Š å½“å‰é—®é¢˜

### é—®é¢˜1ï¼šæœºä¼šè¯†åˆ«ä¸å®¢è§‚
**ä½ç½®ï¼š** `analyze_opportunities_with_new_params` å‡½æ•°ç¬¬15300-15302è¡Œ

```python
# âŒ é”™è¯¯ï¼šç”¨å‚æ•°è¿‡æ»¤æœºä¼š
if signal_score < 60:
    continue  # è·³è¿‡ä¿¡å·åˆ†<60çš„ç‚¹
```

**é—®é¢˜ï¼š** æœºä¼šè¯†åˆ«ä¾èµ–äº`signal_score >= 60`ï¼Œå¯¼è‡´æœºä¼šæœ¬èº«ä¸ä¸­ç«‹

**å½±å“ï¼š** å‚æ•°ä¸åŒçš„æ¨¡å‹ï¼ˆå¦‚DeepSeek vs Qwenï¼‰çœ‹åˆ°çš„æœºä¼šæ•°é‡ä¸ä¸€è‡´ï¼ˆ83 vs 81ï¼‰

### é—®é¢˜2ï¼šæ•è·åˆ¤æ–­æ˜¯"åéªŒ"è€Œé"æ¨¡æ‹Ÿ"
**ä½ç½®ï¼š** ç¬¬15387-15399è¡Œ

```python
# âŒ é”™è¯¯ï¼šåªæ˜¯ç®€å•åˆ¤æ–­æ¡ä»¶æ˜¯å¦æ»¡è¶³
can_old_capture = (
    signal_score >= min_signal_score_old and
    consensus >= min_consensus_old and
    risk_reward >= min_rr_old
)
```

**é—®é¢˜ï¼š** 
- è¿™æ˜¯"é™æ€åˆ¤æ–­"ï¼šå‚æ•°æ¡ä»¶æ˜¯å¦æ»¡è¶³
- ä¸æ˜¯"åŠ¨æ€æ¨¡æ‹Ÿ"ï¼šå¦‚æœç”¨è¿™ä¸ªå‚æ•°äº¤æ˜“ï¼Œå®é™…èƒ½è·å¾—å¤šå°‘åˆ©æ¶¦

**å½±å“ï¼š** å¯¼è‡´100%æ•è·ç‡ï¼Œå› ä¸ºç”¨ç›¸åŒæ¡ä»¶è¯†åˆ«æœºä¼šå’Œåˆ¤æ–­æ•è·

### é—®é¢˜3ï¼šç¼ºå°‘æ•è·åˆ©æ¶¦è®¡ç®—
**å½“å‰åªæœ‰ï¼š**
- `actual_profit_pct`: å®¢è§‚åˆ©æ¶¦ï¼ˆå†å²ä¸Šå®é™…è¾¾åˆ°çš„æœ€å¤§åˆ©æ¶¦ï¼‰

**ç¼ºå°‘ï¼š**
- `old_captured_profit`: å¦‚æœç”¨æ—§å‚æ•°äº¤æ˜“ï¼ŒæŒ‰å…¶æ­¢ç›ˆæ­¢æŸè§„åˆ™èƒ½è·å¾—å¤šå°‘
- `new_captured_profit`: å¦‚æœç”¨æ–°å‚æ•°äº¤æ˜“ï¼ŒæŒ‰å…¶æ­¢ç›ˆæ­¢æŸè§„åˆ™èƒ½è·å¾—å¤šå°‘

**ç¤ºä¾‹å¯¹æ¯”ï¼š**
```
æŸä¸ªæœºä¼šï¼š
- å®é™…åˆ©æ¶¦: +8.5% (å®¢è§‚æ•°æ®ï¼šä»·æ ¼åœ¨24å°æ—¶å†…æ¶¨äº†8.5%)
- æ—§å‚æ•°æ•è·: èƒ½å…¥åœºï¼Œä½†æ­¢ç›ˆè®¾åœ¨+3%ï¼Œåªèƒ½è·å¾— +3%
- æ–°å‚æ•°æ•è·: èƒ½å…¥åœºï¼Œæ­¢ç›ˆè®¾åœ¨+5%ï¼Œå¯ä»¥è·å¾— +5%
- ç»“è®º: æ–°å‚æ•°æ›´å¥½ï¼ˆæ•è·åˆ°æ›´å¤šåˆ©æ¶¦ï¼‰
```

## âœ… æ­£ç¡®çš„é€»è¾‘åº”è¯¥æ˜¯

### æ­¥éª¤1ï¼šå®¢è§‚è¯†åˆ«æœºä¼šï¼ˆå®Œå…¨ä¸­ç«‹ï¼‰
```python
def identify_objective_opportunities(kline_data):
    """
    åªåŸºäºä»·æ ¼èµ°åŠ¿è¯†åˆ«æœºä¼šï¼Œä¸ä¾èµ–ä»»ä½•å‚æ•°
    """
    opportunities = []
    
    for idx, candle in enumerate(kline_data):
        # å‘åçœ‹1å°æ—¶å’Œ24å°æ—¶çš„ä»·æ ¼å˜åŒ–
        future_1h = get_future_data(kline_data, idx, hours=1)
        future_24h = get_future_data(kline_data, idx, hours=24)
        
        # åˆ¤æ–­æ–¹å‘ï¼ˆå¤š/ç©ºï¼‰
        direction = detect_trend_direction(candle)
        
        # è®¡ç®—å®é™…è¾¾åˆ°çš„æœ€å¤§åˆ©æ¶¦
        if direction == 'long':
            scalping_profit = (future_1h['high'].max() - candle['close']) / candle['close'] * 100
            swing_profit = (future_24h['high'].max() - candle['close']) / candle['close'] * 100
        else:
            scalping_profit = (candle['close'] - future_1h['low'].min()) / candle['close'] * 100
            swing_profit = (candle['close'] - future_24h['low'].min()) / candle['close'] * 100
        
        # åˆ¤æ–­æ˜¯å¦ä¸ºæœºä¼šï¼ˆå›ºå®šé˜ˆå€¼ï¼Œä¸ä¾èµ–å‚æ•°ï¼‰
        if scalping_profit >= 1.5 or swing_profit >= 3.0:
            opportunities.append({
                'coin': candle['coin'],
                'time': candle['time'],
                'entry_price': candle['close'],
                'direction': direction,
                'type': 'swing' if swing_profit >= 3.0 else 'scalping',
                'actual_profit': swing_profit if swing_profit >= 3.0 else scalping_profit,
                # ğŸ“Œ å½“æ—¶çš„å¸‚åœºæ•°æ®ï¼ˆç”¨äºåç»­æ¨¡æ‹Ÿï¼‰
                'signal_score': candle['signal_score'],
                'consensus': candle['consensus'],
                'risk_reward': candle['risk_reward'],
                'atr': candle['atr'],
                'future_prices': {
                    '1h': future_1h,
                    '24h': future_24h
                }
            })
    
    return opportunities
```

### æ­¥éª¤2ï¼šæ¨¡æ‹Ÿæ—§å‚æ•°äº¤æ˜“
```python
def simulate_with_params(opportunity, params):
    """
    æ¨¡æ‹Ÿç”¨ç»™å®šå‚æ•°äº¤æ˜“è¿™ä¸ªæœºä¼š
    """
    # 2.1 åˆ¤æ–­æ˜¯å¦ä¼šå…¥åœº
    would_enter = (
        opportunity['signal_score'] >= params['min_signal_score'] and
        opportunity['consensus'] >= params['min_consensus'] and
        opportunity['risk_reward'] >= params['min_risk_reward']
    )
    
    if not would_enter:
        return {
            'captured': False,
            'entry': False,
            'reason': 'å‚æ•°æ¡ä»¶ä¸æ»¡è¶³',
            'profit': 0
        }
    
    # 2.2 å¦‚æœä¼šå…¥åœºï¼Œè®¡ç®—æ­¢ç›ˆæ­¢æŸä»·æ ¼
    entry_price = opportunity['entry_price']
    atr = opportunity['atr']
    direction = opportunity['direction']
    
    # æ ¹æ®å‚æ•°è®¡ç®—æ­¢ç›ˆæ­¢æŸ
    stop_loss_distance = atr * params['atr_stop_multiplier']
    take_profit_distance = stop_loss_distance * params['min_risk_reward']
    
    if direction == 'long':
        stop_loss = entry_price - stop_loss_distance
        take_profit = entry_price + take_profit_distance
    else:
        stop_loss = entry_price + stop_loss_distance
        take_profit = entry_price - take_profit_distance
    
    # 2.3 æ¨¡æ‹Ÿäº¤æ˜“ï¼šçœ‹åç»­ä»·æ ¼èµ°åŠ¿ï¼Œå“ªä¸ªå…ˆè§¦åŠ
    future_prices = opportunity['future_prices']['24h']  # ç”¨24å°æ—¶æ•°æ®
    
    for price_data in future_prices.iterrows():
        high = price_data['high']
        low = price_data['low']
        
        if direction == 'long':
            # å¤šå•ï¼šå…ˆçœ‹æ˜¯å¦è§¦åŠæ­¢æŸ
            if low <= stop_loss:
                return {
                    'captured': True,
                    'entry': True,
                    'exit_type': 'stop_loss',
                    'profit': (stop_loss - entry_price) / entry_price * 100,
                    'exit_price': stop_loss
                }
            # å†çœ‹æ˜¯å¦è§¦åŠæ­¢ç›ˆ
            if high >= take_profit:
                return {
                    'captured': True,
                    'entry': True,
                    'exit_type': 'take_profit',
                    'profit': (take_profit - entry_price) / entry_price * 100,
                    'exit_price': take_profit
                }
        else:  # short
            if high >= stop_loss:
                return {
                    'captured': True,
                    'entry': True,
                    'exit_type': 'stop_loss',
                    'profit': (entry_price - stop_loss) / entry_price * 100,
                    'exit_price': stop_loss
                }
            if low <= take_profit:
                return {
                    'captured': True,
                    'entry': True,
                    'exit_type': 'take_profit',
                    'profit': (entry_price - take_profit) / entry_price * 100,
                    'exit_price': take_profit
                }
    
    # å¦‚æœ24å°æ—¶å†…éƒ½æ²¡è§¦åŠï¼ŒæŒ‰æœ€åä»·æ ¼è®¡ç®—
    last_price = future_prices.iloc[-1]['close']
    if direction == 'long':
        profit = (last_price - entry_price) / entry_price * 100
    else:
        profit = (entry_price - last_price) / entry_price * 100
    
    return {
        'captured': True,
        'entry': True,
        'exit_type': 'holding',
        'profit': profit,
        'exit_price': last_price
    }
```

### æ­¥éª¤3ï¼šå¯¹æ¯”å±•ç¤º
```python
for opp in opportunities:
    # ç”¨æ—§å‚æ•°æ¨¡æ‹Ÿ
    old_result = simulate_with_params(opp, old_params)
    
    # ç”¨æ–°å‚æ•°æ¨¡æ‹Ÿ
    new_result = simulate_with_params(opp, new_params)
    
    # é‚®ä»¶æ˜¾ç¤º
    print(f"""
    æœºä¼š: {opp['coin']} {opp['time']}
    å®é™…åˆ©æ¶¦: {opp['actual_profit']:.1f}%  â† å®¢è§‚æ•°æ®
    
    æ—§å‚æ•°:
      - èƒ½å¦å…¥åœº: {'æ˜¯' if old_result['captured'] else 'å¦'}
      - æ•è·åˆ©æ¶¦: {old_result['profit']:.1f}% â† æŒ‰æ—§å‚æ•°æ­¢ç›ˆæ­¢æŸ
      - å¹³ä»“æ–¹å¼: {old_result.get('exit_type', 'N/A')}
    
    æ–°å‚æ•°:
      - èƒ½å¦å…¥åœº: {'æ˜¯' if new_result['captured'] else 'å¦'}
      - æ•è·åˆ©æ¶¦: {new_result['profit']:.1f}% â† æŒ‰æ–°å‚æ•°æ­¢ç›ˆæ­¢æŸ
      - å¹³ä»“æ–¹å¼: {new_result.get('exit_type', 'N/A')}
    
    å¯¹æ¯”: {'æ–°å‚æ•°æ›´ä¼˜' if new_result['profit'] > old_result['profit'] else 'æ—§å‚æ•°æ›´ä¼˜'}
    """)
```

## ğŸ¯ ä¿®å¤æ¸…å•

### å¿…é¡»ä¿®å¤
1. âœ… ç§»é™¤æœºä¼šè¯†åˆ«ä¸­çš„`signal_score >= 60`è¿‡æ»¤
2. âœ… å°†"æ•è·åˆ¤æ–­"æ”¹ä¸º"æ¨¡æ‹Ÿäº¤æ˜“"
3. âœ… æ·»åŠ æ•è·åˆ©æ¶¦è®¡ç®—
4. âœ… æ›´æ–°é‚®ä»¶æ¨¡æ¿æ˜¾ç¤ºä¸‰ç§åˆ©æ¶¦ï¼š
   - å®é™…åˆ©æ¶¦ï¼ˆå®¢è§‚ï¼‰
   - æ—§å‚æ•°æ•è·åˆ©æ¶¦
   - æ–°å‚æ•°æ•è·åˆ©æ¶¦

### å¯é€‰ä¼˜åŒ–
1. æ·»åŠ å¹³ä»“æ–¹å¼åˆ†æï¼ˆæ­¢ç›ˆ/æ­¢æŸ/æŒæœ‰ï¼‰
2. æ·»åŠ æ•è·æ•ˆç‡åˆ†æï¼ˆæ•è·åˆ©æ¶¦/å®é™…åˆ©æ¶¦çš„æ¯”ä¾‹ï¼‰
3. ç»Ÿè®¡å“ªç§æƒ…å†µå¯¼è‡´åˆ©æ¶¦æŸå¤±ï¼ˆè¿‡æ—©æ­¢ç›ˆ/è¿‡æ—©æ­¢æŸï¼‰

## ğŸ“Š ä¿®å¤åçš„é¢„æœŸæ•ˆæœ

### ä¿®å¤å‰
```
æœºä¼š: 64ä¸ªï¼ˆQwenï¼‰vs 83ä¸ªï¼ˆDeepSeekï¼‰ â† ä¸ä¸€è‡´
æ—§å‚æ•°æ•è·: 83ä¸ª (100%) â† ä¸åˆç†
æ–°å‚æ•°æ•è·: 83ä¸ª (100%) â† ä¸åˆç†
```

### ä¿®å¤å
```
æœºä¼š: 85ä¸ªï¼ˆä¸¤ä¸ªæ¨¡å‹ä¸€è‡´ï¼‰ â† å®¢è§‚è¯†åˆ«
æ—§å‚æ•°æ•è·: 45ä¸ª (53%) â† çœŸå®æ¨¡æ‹Ÿ
  å¹³å‡æ•è·åˆ©æ¶¦: +2.8% (vs å®é™…+5.2%)
æ–°å‚æ•°æ•è·: 62ä¸ª (73%) â† çœŸå®æ¨¡æ‹Ÿ
  å¹³å‡æ•è·åˆ©æ¶¦: +3.5% (vs å®é™…+5.2%)
æ”¹è¿›: æ•è·ç‡æå‡20%ï¼Œåˆ©æ¶¦æå‡25%
```

## ğŸ”§ å®æ–½å»ºè®®

ç”±äºè¿™æ˜¯æ ¸å¿ƒé€»è¾‘çš„å¤§æ”¹åŠ¨ï¼Œå»ºè®®ï¼š
1. å…ˆåœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯æ–°é€»è¾‘
2. ç¡®ä¿æ–°é€»è¾‘èƒ½æ­£ç¡®å¤„ç†å„ç§è¾¹ç•Œæƒ…å†µ
3. æ›´æ–°é‚®ä»¶æ¨¡æ¿ä»¥å±•ç¤ºæ–°çš„å¯¹æ¯”æ•°æ®
4. ä¿ç•™æ—§ç‰ˆæœ¬ä½œä¸ºå¤‡ä»½

---

**è¯Šæ–­æ—¶é—´ï¼š** 2025-11-06  
**ä¸¥é‡ç¨‹åº¦ï¼š** ğŸ”´ é«˜ï¼ˆå½±å“å‚æ•°ä¼˜åŒ–å†³ç­–çš„å‡†ç¡®æ€§ï¼‰  
**å»ºè®®ä¼˜å…ˆçº§ï¼š** P0ï¼ˆç«‹å³ä¿®å¤ï¼‰


